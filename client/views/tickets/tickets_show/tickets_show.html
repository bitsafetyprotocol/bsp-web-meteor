<template name="TicketsShow">
    {{> TicketsIndexSearch }}
    <ul class="breadcrumb">
        <li><a href="/">Home</a></li>
        <li><a href="{{urlFor 'tickets.index'}}">Tickets</a></li>
        <li class="active"><a href="">Ticket #{{ticket.uid}}</a></li>
    </ul>
    <div class="row">
        <div class="col-sm-8">

            <div class="panel {{infoPanelClass ticket.status}} panel-small">
                <div class="panel-heading">
                    <a href="" class="">
                        <span class="fui-user"></span> {{ticket.userName}}
                    </a>

                    <small><span class="fui-arrow-right text-muted"></span></small>

                    reported

                    <a href="{{urlFor 'tickets.show' uid=ticket.uid}}">
                        case #{{ticket.uid}}
                    </a>
                    <span class="text-muted pull-right">
                        {{timeAgo ticket.createdAt}}
                    </span>
                </div>
                <div class="panel-body">
                    <p class="lead">{{ticket.subject}}</p>
                    {{ticket.description}}
                </div>
            </div>

            {{#each ticket.updates}}
                {{> TicketUpdatesPartial}}
            {{/each}}

            {{> TicketShowCommentForm }}
        </div>

        <div class="col-sm-4">{{> TicketsShowSidebar }}</div>

    </div>
</template>

<template name="TicketUpdatesPartial">
    <div class="panel panel-info panel-small">
        <div class="panel-heading panel-heading-condensed">
            <a href="" class="">
                <span class="fui-user"></span> {{userName}}
            </a>

            <small><span class="fui-arrow-right text-muted"></span></small>

            updated

            <a href="{{urlFor 'tickets.show' uid=ticket.uid}}">
                case #{{ticket.uid}}
            </a>
            <span class="text-muted pull-right">
                {{timeAgo createdAt}}
                &nbsp; <button class="close">&times;</button>
            </span>
        </div>
        <div class="panel-body">
            {{> TicketShowChanges}}
        </div>
    </div>
</template>

<template name="TicketShowChanges">
    {{#if comment}}
    <div class="row">
        <div class="col-sm-2">
            <code>comment</code>
        </div>
        <div class="col-sm-10">
            {{comment}}
        </div>
    </div>
    {{/if}}
    {{#each fields}}
    <div class="row">
        <div class="col-sm-3">
            <code>{{name}}</code>
        </div>
        <div class="col-sm-4 text-right text-muted">{{before}}</div>
        <div class="col-sm-1 text-center">
            <span class="text-muted fui-arrow-right"></span>
        </div>
        <div class="col-sm-4 text-left">{{after}}</div>
    </div>
    {{/each}}
</template>

<template name="TicketShowCommentForm">
    <div class="panel panel-info panel-small" id="ticketCommentForm">
        <div class="panel-heading panel-heading-condensed">
            <a href="" class="">
                <span class="fui-user"></span> {{ticket.userName}}
            </a>

            <small><span class="fui-arrow-right text-muted"></span></small>

            new comment for

            <a href="{{urlFor 'tickets.show' uid=ticket.uid}}">
                case #{{ticket.uid}}
            </a>
            <button class="btn btn-info btn-sm pull-right postComment">Send</button>
        </div>
        <div class="panel-body">
            <textarea class="form-control" placeholder="Your comment on this case" rows="4"></textarea>
        </div>
    </div>
</template>

